<section class="product-listing">
  <div class="container">
    <div style="display: flex; flex-wrap: wrap; gap: 24px;">
      {% for product in context.products %}
        <a href="/product/{{ product.slug }}" style="width: 280px; text-decoration: none; color: inherit; border: 1px solid #eee; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: block; transition: transform 0.2s;">
          
          <!-- صورة المنتج -->
          {% if product.images and product.images.length > 0 %}
            <div style="width: 100%; height: 180px; background: #f9f9f9;">
              <img 
                src="{{ product.images[0].fileUrl }}" 
                alt="{{ product.title }}" 
                style="width: 100%; height: 100%; object-fit: cover;"
              />
            </div>
          {% else %}
            <div style="width: 100%; height: 180px; background: #ddd; display: flex; align-items: center; justify-content: center;">
              <span style="color: #888;">لا توجد صورة</span>
            </div>
          {% endif %}

          <!-- تفاصيل المنتج -->
          <div style="padding: 16px;">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">
              {{ product.title }}
            </h2>

            {% if product.pricing %}
              <div style="margin-bottom: 8px;">
                <span style="font-weight: bold; color: #27ae60;">
                  {{ product.pricing.price }} EGP
                </span>
                {% if product.pricing.compareAtPrice > product.pricing.price %}
                  <span style="text-decoration: line-through; color: #999; margin-left: 8px;">
                    {{ product.pricing.compareAtPrice }} EGP
                  </span>
                  <span style="color: #e74c3c; font-size: 14px; margin-left: 8px;">
                    -{{ product.pricing.discount.discountValue }}%
                  </span>
                {% endif %}
              </div>
            {% endif %}

            <!-- الكمية -->
            <p style="font-size: 14px; color: #555; margin-bottom: 4px;">
              <strong>الكمية:</strong> {{ product.quantity }}
            </p>

            <!-- الحالة -->
            {% if product.status == 'draft' %}
              <p style="font-size: 14px; color: #e67e22;">
                <strong>الحالة:</strong> مسودة
              </p>
            {% else %}
              <p style="font-size: 14px; color: #2ecc71;">
                <strong>الحالة:</strong> منشور
              </p>
            {% endif %}
          </div>
        </a>
      {% endfor %}
    </div>
  </div>
</section>