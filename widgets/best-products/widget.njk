{% set products = widget.data.products %}
<style>
  /* ===== Container ===== */
  .cs-modern {
    display: grid;
    grid-template-columns: 1fr;
    gap: 16px;
  }
  /* ===== Card ===== */
  .cs-card {
    position: relative;
    border-radius: 20px;
    overflow: hidden;
    background: #0f172a;
    color: #fff;
    box-shadow: 0 20px 40px rgba(0, 0, 0, .25);
  }
  /* ===== Image ===== */
  .cs-image {
    position: relative;
    height: 190px;
    background: #020617;
  }
  .cs-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  /* gradient overlay */
  .cs-image::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(2,6,23,.9), rgba(2,6,23,.2), transparent);
  }
  /* ===== Discount ===== */
  .cs-discount {
    position: absolute;
    top: 12px;
    inset-inline-start: 12px;
    background: #ef4444;
    color: #fff;
    font-size: 12px;
    font-weight: 800;
    padding: 6px 10px;
    border-radius: 999px;
  }
  /* ===== Body ===== */
  .cs-body {
    padding: 14px 16px 18px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  /* title */
  .cs-title {
    font-size: 16px;
    font-weight: 800;
    line-height: 1.3;
  }
  /* description */
  .cs-desc {
    font-size: 13px;
    color: #cbd5f5;
    line-height: 1.5;
    max-height: 40px;
    overflow: hidden;
  }
  /* ===== Price ===== */
  .cs-price {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .cs-price-current {
    font-size: 18px;
    font-weight: 900;
    color: #22c55e;
  }
  .cs-price-old {
    font-size: 13px;
    text-decoration: line-through;
    color: #94a3b8;
  }
  /* ===== CTA ===== */
  .cs-cta {
    margin-top: 10px;
    width: 100%;
    padding: 12px;
    border-radius: 14px;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    border: none;
    color: #020617;
    font-size: 14px;
    font-weight: 900;
    cursor: pointer;
    transition: 0.2s ease;
  }
  .cs-cta:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(34, 197, 94, .4);
  }
  /* ===== Empty ===== */
  .cs-empty {
    text-align: center;
    font-size: 13px;
    color: #64748b;
  }
</style>
<div class="cs-modern">
  {% if products and (products | length) > 0 %}
    {% for product in products %}
      <div
        class="cs-card">
        <!-- IMAGE -->
        <div class="cs-image">
          {% if product.images and product.images | length > 0 %}
            <img src="{{ product.images[0].fileUrl }}" alt="{{ product.title }}">
            {% else %}
              <img src="https://placehold.co/600x400?text=No+Image">
              {% endif %}
              {% if product.pricing
          and product.pricing.compareAtPrice
          and product.pricing.compareAtPrice > product.pricing.price %}
                {% set discount =
            ((product.pricing.compareAtPrice - product.pricing.price)
            / product.pricing.compareAtPrice * 100) | round %}
                <div class="cs-discount">
                  -{{ discount }}%
                </div>
              {% endif %}
            </div>
            <!-- BODY -->
            <div class="cs-body">
              <div class="cs-title">
                {{ product.title }}
              </div>
              <div class="cs-desc">
                {{ product.description | default("اختيار ممتاز مع المنتج الحالي") }}
              </div>
              <div class="cs-price">
                {% if product.pricing and product.pricing.price > 0 %}
                  <span class="cs-price-current">
                    {{ product.pricing.price }} جنيه
                  </span>
                {% endif %}
                {% if product.pricing and product.pricing.compareAtPrice %}
                  <span class="cs-price-old">
                    {{ product.pricing.compareAtPrice }} جنيه
                  </span>
                {% endif %}
              </div>
              <button class="cs-cta">
                أضف للسلة مع الطلب
              </button>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <div class="cs-empty">
          لا توجد منتجات مقترحة
        </div>
      {% endif %}
    </div>