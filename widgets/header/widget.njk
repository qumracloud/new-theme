<!-- Header & Interactive Modals Controller -->
<div class="sticky top-0 z-50">
  <header
    class="left-0 w-full z-40 bg-white/95 backdrop-blur-md shadow-lg border-b border-gray-200 transition-all duration-300">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-[auto_1fr_auto] items-center py-4">
            <!-- Left column: mobile burger, desktop icons -->
            <div class="flex items-center justify-start">
                <!-- Mobile: Category (hamburger) icon only -->
                <button @click="toggleModal('sidebar')" aria-label="القائمة" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 lg:hidden">
                    <svg class="h-6 w-6 text-gray-700"
                        viewBox="0 0 22 22"
                        stroke="currentColor" stroke-width="1.9">
                        <path d="M1 5h20M1 11h20M1 17h20" stroke-linecap="round"></path>
                    </svg>
                </button>
                <!-- Desktop: logo on the left -->
                <a href="/" class="hidden lg:flex hover:opacity-80 transition-opacity duration-200">
                    <img src="{{globals.app.logo.fileUrl}}" alt="Matjrna Logo"
                        class="h-12 md:h-16 w-auto">
                </a>
            </div>
            <!-- Center column: mobile logo, desktop menu in center -->
            <div class="flex justify-center min-w-0">
                <!-- Mobile logo -->
                <a href="/" class="hover:opacity-80 transition-opacity duration-200 lg:hidden">
                    <img src="{{globals.app.logo.fileUrl}}" alt="Matjrna Logo"
                        class="h-12 md:h-16 w-auto">
                </a>
                <!-- Desktop: center menu items from header_menu -->
                <div class="relative hidden lg:flex items-center justify-center w-full min-w-0">
                    <nav class="flex items-center justify-center gap-x-5 xl:gap-x-7">
                        {% set items = widget.data.header_menu or [] %}
                        {% for item in items %}
                        {% if loop.index0 < 4 %}
                        <a href="{{ item.url | default('#') }}" class="text-gray-700 hover:text-black font-semibold whitespace-nowrap transition-colors duration-200">{{ item.title | default('بدون عنوان') }}</a>
                        {% endif %}
                        {% endfor %}
                        {% if items | length > 4 %}
                        <div class="relative group">
                            <button class="w-8 h-8 inline-flex items-center justify-center rounded-md hover:bg-gray-100 text-gray-700 transition-colors duration-200" aria-label="المزيد">⋯</button>
                            <div class="absolute top-full mt-2 right-0 bg-white border border-gray-200 rounded-lg shadow-lg py-2 z-50 min-w-[12rem] opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                                {% for item in items %}
                                {% if loop.index0 >= 4 %}
                                <a href="{{ item.url | default('#') }}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 whitespace-nowrap">{{ item.title | default('بدون عنوان') }}</a>
                                {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </nav>
                </div>
            </div>
            <!-- Right column: desktop logo, mobile icons -->
            <div class="flex items-center gap-x-4 justify-end">
                <!-- Desktop: utility icons on the right -->
                <div class="hidden lg:flex items-center gap-x-4">
                    <button @click="toggleModal('search')" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 cursor-pointer" aria-label="بحث">
                        <svg class="h-6 w-6 text-gray-700"
                            viewBox="0 0 22 22" stroke="currentColor" stroke-width="1.9" fill="none">
                            <circle cx="11" cy="10" r="7"></circle>
                            <path d="m16 15 3 3" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    {% if globals.customer._id %}
                    <button class="logout p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="الحساب">
                        <img src="{{ globals.customer.account.avatarUrl }}" class="object-contain w-6 h-6 rounded-full border-2 border-gray-200"
                            alt="">
                    </button>
                    {% else %}
                    <button class="login p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="الحساب">
                        <svg class="h-6 w-6 text-gray-700" viewBox="0 0 22 22" stroke="currentColor" stroke-width="1.9" fill="none">
                            <circle cx="11" cy="7" r="4"></circle>
                            <path d="M3.5 19c1.421-2.974 4.247-5 7.5-5s6.079 2.026 7.5 5" stroke-linecap="round"></path>
                        </svg>
                    </button>
                    {% endif %}
                    <button @click="toggleModal('cart')" class="relative p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="عربة التسوق"
                        @click.prevent="cartOpen = true">
                        <svg class="h-6 w-6 text-gray-700" viewBox="0 0 22 22" stroke="currentColor"
                            stroke-width="1.9">
                            <path
                                d="M9.182 18.454a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.818 0Zm7.272 0a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.819 0Z"
                                fill="currentColor"></path>
                            <path
                                d="M5.336 6.636H21l-3.636 8.182H6.909L4.636 3H1m8.182 15.454a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.818 0Zm7.272 0a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.819 0Z"
                                fill="none" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                        <span x-text="globals?.cart?.items?.length || 0"
                            class="absolute -top-2 -right-2 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-white shadow-lg font-['Cairo',sans-serif]"></span>
                    </button>
                </div>
                <!-- Mobile: right-side icons -->
                <div class="flex lg:hidden items-center gap-x-4">
                    <button @click="toggleModal('search')" class="p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 cursor-pointer" aria-label="بحث">
                        <svg class="h-6 w-6 text-gray-700"
                            viewBox="0 0 22 22" stroke="currentColor" stroke-width="1.9" fill="none">
                            <circle cx="11" cy="10" r="7"></circle>
                            <path d="m16 15 3 3" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                    {% if globals.customer._id %}
                    <button class="logout p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="الحساب">
                        <img src="{{ globals.customer.account.avatarUrl }}" class="object-contain w-6 h-6 rounded-full border-2 border-gray-200" alt="">
                    </button>
                    {% else %}
                    <button class="login p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="الحساب">
                        <svg class="h-6 w-6 text-gray-700" viewBox="0 0 22 22" stroke="currentColor" stroke-width="1.9" fill="none">
                            <circle cx="11" cy="7" r="4"></circle>
                            <path d="M3.5 19c1.421-2.974 4.247-5 7.5-5s6.079 2.026 7.5 5" stroke-linecap="round"></path>
                        </svg>
                    </button>
                    {% endif %}
                    <button @click="toggleModal('cart')" class="relative p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200" aria-label="عربة التسوق"
                        @click.prevent="cartOpen = true">
                        <svg class="h-6 w-6 text-gray-700" viewBox="0 0 22 22" stroke="currentColor"
                            stroke-width="1.9">
                            <path
                                d="M9.182 18.454a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.818 0Zm7.272 0a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.819 0Z"
                                fill="currentColor"></path>
                            <path
                                d="M5.336 6.636H21l-3.636 8.182H6.909L4.636 3H1m8.182 15.454a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.818 0Zm7.272 0a.91.91 0 1 1-1.818 0 .91.91 0 0 1 1.819 0Z"
                                fill="none" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                        <span x-text="globals?.cart?.items?.length || 0"
                            class="absolute -top-2 -right-2 bg-gradient-to-r from-red-500 to-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-white shadow-lg font-['Cairo',sans-serif]"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
  </header>
</div>




<!-- ############### END: PROFESSIONAL CART SIDE-PANEL ############### -->
{%ui "sidebar.njk", menu=widget.data.header_menu %}
{%ui "search.njk" %}
{%ui "cart.njk" %}

<style>
/* Mobile Padding Fix for Header */
@media (max-width: 640px) {
  .container {
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
}
</style>